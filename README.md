# üñºÔ∏è –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –ø–æ–º–æ—â—å—é U-Net –∏ PyTorch

–ü–∞–π–ø–ª–∞–π–Ω –±–∏–Ω–∞—Ä–Ω–æ–π —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É U-Net —Å —ç–Ω–∫–æ–¥–µ—Ä–æ–º ResNet. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–±—É—á–µ–Ω–∏–µ, –æ—Ü–µ–Ω–∫—É –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –º–∞—Å–æ–∫ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏.

### 1. –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤

```
project/
‚îú‚îÄ‚îÄ code/
‚îÇ   ‚îú‚îÄ‚îÄ dataset.py    # –ó–∞–≥—Ä—É–∑—á–∏–∫ –¥–∞—Ç–∞—Å–µ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ model.py      # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
‚îÇ   ‚îî‚îÄ‚îÄ main.py       # –ü–∞–π–ø–ª–∞–π–Ω –æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ im_train/         # –û–±—É—á–∞—é—â–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (.jpg, .png)
‚îú‚îÄ‚îÄ mask_train/       # –ú–∞—Å–∫–∏ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è (–æ–±—ä–µ–∫—Ç—ã = 255)
‚îú‚îÄ‚îÄ im_val/           # –í–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ mask_val/         # –í–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–∞—Å–∫–∏
‚îú‚îÄ‚îÄ im_test/          # –¢–µ—Å—Ç–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
‚îî‚îÄ‚îÄ mask_test/        # –¢–µ—Å—Ç–æ–≤—ã–µ –º–∞—Å–∫–∏

```


## 2. ‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã (`main.py`)

```python
epochs_max = 5             # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö –æ–±—É—á–µ–Ω–∏—è
batch_size = 8             # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–∞–º—è—Ç–∏ GPU
input_image_reshape = (128, 128)  # –†–∞–∑–º–µ—Ä –≤—Ö–æ–¥–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
foreground_class = 255     # –ó–Ω–∞—á–µ–Ω–∏–µ –ø–∏–∫—Å–µ–ª—è –æ–±—ä–µ–∫—Ç–∞ –Ω–∞ –º–∞—Å–∫–µ
adam_lr = 2e-4             # –°–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è
```

## 3. üìä –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:

```
project/
‚îî‚îÄ‚îÄ output_images/
    ‚îú‚îÄ‚îÄ train_val_losses.png     # –ì—Ä–∞—Ñ–∏–∫–∏ –ø–æ—Ç–µ—Ä—å
    ‚îú‚îÄ‚îÄ output_0.png             # –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
    ‚îú‚îÄ‚îÄ output_1.png             # (–≤—Ö–æ–¥ + –º–∞—Å–∫–∏)
    ‚îî‚îÄ‚îÄ ...
```

–ö–æ–Ω—Å–æ–ª—å –≤—ã–≤–æ–¥–∏—Ç –º–µ—Ç—Ä–∏–∫–∏:

```log
Test Loss: 0.123, IoU Score: 0.85, Accuracy: 0.92, F1 score: 0.88
Trained model saved as: modellll.bin
```


## 4. üí° –°–æ–≤–µ—Ç—ã –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

1. **–ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫**: —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `epochs_max=1` –∏ `batch_size=2` –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
2. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–∞—Å–æ–∫**:

   * –û–±—ä–µ–∫—Ç—ã: –±–µ–ª—ã–π (255)
   * –§–æ–Ω: —á—ë—Ä–Ω—ã–π (0)
   * –ù–∞–∑–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –¥–æ–ª–∂–Ω—ã —Å–æ–≤–ø–∞–¥–∞—Ç—å –º–µ–∂–¥—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –∏ –º–∞—Å–∫–∞–º–∏

## 5. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ—Ü–µ—Å—Å–∞**:

   * –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ `output_images/` –≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è
   * –ò–∑–º–µ–Ω—è–π—Ç–µ —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è, –µ—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å –ø–µ—Ä–µ—Å—Ç–∞–ª–∞ —É–º–µ–Ω—å—à–∞—Ç—å—Å—è

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –û–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–∞–∫ `modellll.bin` –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞. –î–æ–±–∞–≤—å—Ç–µ –∫–æ–¥ –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞, —á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ—ë –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π.
